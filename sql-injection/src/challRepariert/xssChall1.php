<!DOCTYPE html>
<html lang="en">
<title> XSS-Injection</title>

<head>

    <link rel="stylesheet" href="../css/Style.css">
</head>

<body>

    <form action="xssChall1.php" method="POST" id="f">

        <input type="checkbox" id="flag" name="check">
        <input type="checkbox" id="solution" name="hint1" />
        <div class=" title">

            <div style="margin: 5px 880px;font-size: 14px; position: absolute; "><a href="http://localhost"
                    style="text-decoration: none;"> <span style="color :#0c2461; ">Home</span></a></div>
            <div style="margin: 5px 945px;font-size: 13px; position: absolute; width:145px;"><a
                    href="http://localhost:5000/command_injection_1" style="text-decoration: none;"> <span
                        style="color :#0c2461; ">Command-Injection</span></a></div>
            <div style="margin: 5px 1080px;font-size: 13px; position: absolute; width:145px;"><a
                    href="http://localhost:3000" style="text-decoration: none;"> <span
                        style="color :#0c2461; ">Path-Traversal</span></a></div>
            <div style="margin: 5px 1200px;font-size: 13px; position: absolute; width:145px;"><a
                    href="http://localhost:8026/xssMain.php" style="text-decoration: none;"> <span
                        style="color :#0c2461; ">SQL-Injection</span></a></div>

            <h1 style="padding: 0px 44px;font-size: 20px; text-align:left;"> Web Exploitation Demos
            </h1>
        </div>

        <div class="box">
            <h1> XSS-Injection</h1>
            <ul>
                <li>
                    <a href="../../Einleitung/einleitung2.php" style="text-decoration:none;"><span
                            style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><a href="../xssChallenge/xssRef1.php" style="color :#0c2461; text-decoration:none;"> (1)
                        Reflektiertes
                        XSS</a>

                </li>
                <li>
                    <a href="../challRepariert/xssChall1.php" style="text-decoration: none;"><span
                            style="color:#0c2461">
                            (1)
                            Challenge geschützt</span></a>
                </li>
                <li><span style="color:#0c2461"> (2) Persistentes XSS </span>
                    <label for="flag" class="flag3"> (2) Persistentes XSS Persistentes XSS </label>
                </li>
                <li>
                    <a href="../challRepariert/xssChall2.php" style="text-decoration: none;"><span
                            style="color:#0c2461">
                            (2) Challenge geschützt</span></a>
                </li>
            </ul>

            </ul>
        </div>

        <div class="Rahmen">
            <?php

            $flag = trim($_POST['flag_eingabe']);
            if ($flag == "done_Ref26254" && (isset($_POST['flag_btn']))) {
                echo ' <script type="text/javascript">
                 window.location.href = "/xssChallenge/xssPers1.php";
                   </script>';
            }
            ?>

            <div>
                <p style="color:blue; margin:10px 160px;position: absolute;"> Challenge 1: Demonstration einer
                    reflektierten XSS-Injection </p>
            </div>
            <div>
                <p style="position: absolute;margin: 52px 40px;font-size: 14px;"> Diese Challelge ist aufeinander in 3
                    Stufen aufgebaut. Um von einer zu anderen Stufe zu kommen muss ein Code im Textfeld eingegeben
                    werden. Einen Code bekommst du, wenn du die jeweilige Stufe gelöst hast. </p></br><br><br>
            </div>
            <div>
                <p style="margin: 35px 41px;font-size: 14px;"> Nachdem alle 3 Stufen gelöst wurden, erhältst du den Flag
                    für die nächste Challenge "Persistentes XSS".</p>
            </div>
            <div
                style="margin: -15px 90px; background-color: #06f20659;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <span style=" color:black; margin: 17px 30px; position: absolute;"> Einfach</span>
            </div>
            <div
                style="margin: -15px 240px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <span style=" color:black;position:absolute; margin:17px 38px;">Mittel</span>
            </div>
            <div
                style="margin: -15px 390px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <span style=" color:black;position:absolute; margin:17px 33px;">Schwer</span>
            </div>
            <div
                style="margin: -15px 540px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <label for="solution" style=" color:black;position:absolute; margin:17px 27px;">Lösungen</label>
            </div>
            <div class="deco_rahmen">
                <div class="inhalt_rahmen">
                    <p style="margin: 15px 100px;"><br>Geben Sie den Code ein: </p> <input type="text" name="code"
                        style="margin: -43px 315px; position:absolute;">

                    <button type="submit" name="sub"
                        style="color: green; margin: -39px 544px;position:absolute;">Submit</button>

                    <div style="background-color: #0000001a;height: 180px;margin: 44px 32px;width: 820px;">
                        <div
                            style="background-color: white;position: absolute;height: 160px;width: 800px;margin: 10px 10px;">
                            <?php



                            if (($_POST["code"]) == 12) {

                                echo ' <script type="text/javascript">
                                window.location.href = "xssRef2.php";
                                </script>';
                            } else {
                                echo  '<span style="position: absolute;width: 600px;margin: 45px 92px;" ><strong>Stufe 1:</strong> Erstelle ein XSS payload, das ein Popup * Code * anzeigt.</span>' . "<br><br>";
                            }

                            ?>
                        </div>
                    </div>
                    <?php
                    include '../sql_conn.php';
                    $text = htmlspecialchars(stripslashes(trim($_POST['text'], ENT_QUOTES)));
                    // $str = json_encode($text, JSON_HEX_QUOT | JSON_HEX_TAG | JSON_HEX_AMP | JSON_HEX_APOS);

                    echo  $text . "<br><br><br><br>";

                    ?>
                    <div style="position: absolute;margin: -111px 12px;">
                        <?php
                        $str = "<script>
                alert(1)
                </script>";
                        echo "<strong>Gebe ausführbare XSS-Injection Textcode</strong> " . htmlentities($str) . " <strong>ein.</strong> <br>"; ?>
                    </div>
                    <div style="background: black;width: 420px;height: 183px;position: absolute;margin: -213px -443px;">
                        <strong style="margin: 12px 25px;position: absolute; font-size:16px;width: 400px;color: white;">
                            Mögliche
                            ergreifbare Schutzmaßnahme:
                        </strong> <br><br>

                        <span
                            style="color:white;text-align: left;font-size: 13px;width: 400px;position: absolute;margin: 5px 25px;">Hier
                            werden die Benutzereingaben mit htmlspecialchars bereinigt, damit keine Javascriptcode
                            ausgeführt werden kann. Ein Code dafür ist: <br><br>

                            $text = htmlspecialchars(stripslashes(trim($_POST['text'])));<br>
                            trim- entfernt das Leerzeichen<br>
                            stripslashes- convertiert die Schrägstriche. <br>
                        </span>
                    </div>
                    <p style="margin: -47px 10px;"> Antwort eingeben: </p>
                    <input type="text" name="text" style="position: absolute;margin: 22px 167px;">
                    <button type="submit" name="submit"
                        style="color:blue;position: absolute;margin: 25px 397px;width: 178px;">Eingaben
                        absenden</button>

                </div>
            </div>

        </div>
        <div class="flag_popup">
            <div class="flag_eingabe">
                <input type="text" id="flag_text" name="flag_eingabe" autocomplete="off"
                    placeholder="Geben sie Flag ein:" style="width: 322px;height: 40px; margin: 1px 20px; ">
            </div>
            <div class="flag_btn">
                <input type="submit" name="flag_btn" value="submit"
                    style="  height: 40px;width: 350px; margin: 10px 30px;
                    background: #00dbff52; border-top-right-radius: 10px; border-top-left-radius: 10px;border-bottom-right-radius: 10px; border-bottom-left-radius: 10px;">
            </div>
        </div>
        <div class="hint" style="margin: 0px -135px;">
            <ul>
                <li>
                    <p style="margin: 3px 13px;">Hinweis1</p>
                    <div class="content">

                        <p style="margin: -7px -4px;"> In Javascript wird am häufigsten eine XSS-Sicherheitslücke
                            <br><br>durch die Javascript-Funktion <br><br>
                            <?php $str = "<script>alert()</script>";
                            echo htmlentities($str); ?> überprüft.<br><br>
                        </p>
                    </div>

                </li>
                <li>
                    <p style="margin: 3px 13px;">Hinweis2</p>
                    <div class="content">

                        <p style="margin: 54px -4px;"> Setze den String in * ' * Anführungs­zeichen.
                        </p>
                    </div>

                </li>

            </ul>
        </div>
        <div class="Solution" style="margin: 391px 19px;height: 183px;">
            <p style="margin: 50px 30px"> Stufe 1: <?php $str = "<script>alert('Code')</script>";
                                                    echo htmlentities($str); ?> <br><br>
            </p>
        </div>
    </form>
    <form action="../xssMain.php" method="POST" style="width: 0px; height:0px; margin:0px 0px;">

        <div class="back" style="margin: 65px -560px;position: absolute;"><input type="submit" name="back1"
                value="Zurück zur Challenge Seite" style="    background: none;   border: none;color: Blue;"></div>
    </form>
</body>

</html>