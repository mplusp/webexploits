


<!DOCTYPE html>
<html lang="en">
<title> XSS-Injection</title>
<head>
   
    <link rel="stylesheet" href="Style.css">
</head>
<body>
<?php 


echo  '<strong>Stufe 1:</strong> Erstelle ein XSS payload, das ein Popup * Code * anzeigt.'."<br><br>";

$text = $_POST['text'];
$aufgabe1 ="<script> alert('Code')</script>";
$aufgabe3="<img src=1 onerror =alert('Code')>";
$aufgabe2="<script> alert(window.location.host)</script>";
$str = htmlentities($text); 
echo $text. "<br>";
if($text == $aufgabe1){
 $Confirmation = "<script> window.confirm('Glückwünsch!  Flag fuer naechste Stufe: 12');   </script>";
        if ($Confirmation == true) {
 echo $Confirmation;
	}
}
?>

<?php
echo'<label for="hint1" class="hint"  style="margin: 52px 8px;">Hinweis 1</label>';
echo'<label for="hint2" class="hint"  style="margin: 215px 8px;">Hinweis 1</label>';
echo'<label for="hint3" class="hint" style="margin: 215px 134px;">Hinweis 2</label>';

echo'<label for="hint4" class="hint"  style="margin: 413px 8px;">Hinweis 1</label>';
echo'<label for="hint5" class ="hint"  style="margin: 413px 134px;">Hinweis 2</label>';
echo'<label for="hint6" class ="hint"  style="margin: 413px 260px;">Hinweis 3</label>';

?>

<form action="xssRef.php" method="POST">
<input type="text" name="text" >
   <button type="submit" name="submit" style="color:blue;">Eingaben absenden</button> 
<input type="text" name="Flag" placeholder="Flag eingeben " style="margin: 0px 100px;" > 
<button type="submit" name="sub" style="color: green; margin: 0px -100px;">Submit</button>

</form>  
   <input type="checkbox" id="hint1" name="hint1" />
   <input type="checkbox" id="hint2" name="check" />
   <input type="checkbox" id="hint3" name="check" />
   <input type="checkbox" id="hint4" name="check" />
   <input type="checkbox" id="hint5" name="check" />
   <input type="checkbox" id="hint6" name="check" />

<?php 

$text1 = $_POST['text1'];
echo  '<span style="position: absolute;margin: 57px 0px;"><strong>Stufe 2:</strong> Erstelle ein XSS payload, die ein Popup mit dem Host deines Rechners anzeigt.</span>'."<br><br>";
$str = htmlentities($text1);
echo"<br><br><br>".$text1. "<br>";

if($text1 == $aufgabe2){
 $Confirmation = "<script> window.confirm('Glückwünsch!  Flag fuer naechste Stufe: 22');   </script>";
        if ($Confirmation == true) {
 echo $Confirmation;
}
}


?>
<form action="xssRef.php" method="POST" style="margin: 15px 0px;">
<input type= "text" name ="text1" disabled>
<button type="submit" name="submit1" style="color:blue;">Eingaben absenden</button>
<?php if($_POST['Flag']==12 |isset($_POST['submit1'])){$_POST['Flag']=12; echo '<input type= "text" name ="text1" style="margin: 0px -409px;position: absolute;"/>';} ?>
<input type="text" name="Flag1" placeholder="Flag eingeben " style="margin: 0px 100px;" > 
<button type="submit" name="sub1" style="color: green; margin: 0px -100px;">Submit</button>
</form>

<?php 

$text2 = $_POST['text2'];
echo  '<span style="position: absolute;margin: 57px 0px;"><strong>Stufe 3:</strong> Um solche Angriffe zu vermeiden, hat die Entwicklerin das script-Tag blockiert. Finde Wege, <br> die  ein Popup * Code * anzeigen.</span>'."<br><br>";
$str = htmlentities($text2); 
if($text2==str_replace("<script>","",$text2)){
echo"<br><br><br><br>". $text2."<br>";
}
else{
$ab = str_replace('<script>','',$text2) ;
echo"<br><br><br><br>". $ab."<br>";

}
if($text2 == $aufgabe3 | $ab==$aufgabe1){
 $Confirmation = "<script> window.confirm('Glückwünsch!  Flag fuer naechste Stufe: 3');   </script>";
        if ($Confirmation == true) {
 echo $Confirmation;
}
} 
?>
<form action="xssRef.php" method="POST" style="margin: 15px 0px;">
<input type= "text" name ="text2" disabled/>
<button type="submit" name="submit2" style="color:blue;">Eingaben absenden</button>
<?php if($_POST['Flag1']==22 |isset($_POST['submit2'])){$_POST['Flag']=22;echo '<input type= "text" name ="text1" style="margin: -205px -409px;position: absolute;height: 40px;"/>'; echo '<input type= "text" name ="text2" style="margin: 0px -409px;position: absolute;"/>';} ?> 
<input type="text" name="Flag2" placeholder="Flag eingeben " style="margin: 0px 100px;" > 
<button type="submit" name="sub" style="color: green; margin: 0px -100px;">Submit</button>
</form>
<form action="../index.php" method="POST">

<div class ="back" style="margin: 40px 60px;position: absolute;"><input type ="submit" name ="back1" value="Zurück"style="background: bottom;width: 94px;height: 40px;"></div> 
</form>
<?php 
echo'<div class ="hint_popup"><p style="font-size: 13px;white-space: pre-wrap;"><strong style="margin: 55px 9px;width: 500px;position: absolute;font-size: 14px;"> In Javascript wird am häufigsten eine XSS-Sicherheitslücke durch die Javascript-Funktion „< script>alert()< /script> “ überprüft. </strong> </p></div>';
echo'<div class ="hint_popup1" style="position: absolute;margin: -276px 890px;><p style="font-size: 15px;white-space: pre-wrap;"><strong style="margin: 40px 9px;position: absolute;font-size: 15px;"> Das window.location-Objekt kann verwendet werden, um die aktuelle Seitenadresse (URL) zu ermitteln und den Browser auf eine neue Seite umzuleiten. </strong> </p></div>';
echo'<div class ="hint_popup2"style="position: absolute;margin: -276px 890px;"><p style="font-size: 15px;white-space: pre-wrap;"><strong style="margin: 40px 9px;position:absolute;"> Ein Beispiel von Zurückgeben  einer URL der aktuellen Seite:<br> <br> window.location.href</strong></p></div>';
echo'<div class ="hint_popup3"style="position: absolute;margin: -80px 890px;"><p style="font-size: 15px;white-space: pre-wrap;"><strong style="margin: 40px 9px;position:absolute;"> Du hast die Möglichkeiten diese Stufe mit oder ohne script-Tag zu lösen. </strong> </p></div>';
echo'<div class ="hint_popup4"style="position: absolute;margin: -80px 890px;"><p style="font-size: 15px;white-space: pre-wrap;"><strong style="margin: 13px 9px;position: absolute;font-size: 15px;"> Hinweis mit script-Tag: <br><br> Script-Tag Blockieren bedeutet nicht, dass diese Website nicht angreifbar ist, es bedeutet nur, dass die Nutzlast verborgen wird, um einer Erkennung zu entgehen.</strong> </p></div>';
echo'<div class ="hint_popup5"style="position: absolute;margin: -80px 890px;"><p style="font-size: 13px;white-space: pre-wrap;"><strong style="margin: -10px 9px;position: absolute;">Hinweis ohne script-Tag:<br><br> -> Die Zeichen „< >“  dienen dazu, das aktuelle HTML-Tag zu umgehen. <br> -> Wenn du auf „< img src=x“  verweisen, führt dies zu einem Fehler, da die Anwendung die Ressource x nicht finden kann. Dies geschieht absichtlich, um den Ereignis-Handler onerror zu nutzen. <br> -> alert(), das als Nachweis dafür dient, dass das Skript ausgeführt wurde.</strong> </p></div>';

?>
<?php
 if($_POST['Flag2']==3){
echo'<strong style="position: absolute;margin: 48px 190px;"> Flag fuer naechste Challenge ist summe von alle 3 Stufen. </strong> ';
}
?>

<body>
<html>
