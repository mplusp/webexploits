<!DOCTYPE html>
<html lang="en">
<title> XSS-Injection</title>

<head>

    <link rel="stylesheet" href="Style.css">
</head>

<body>

    <form action="xssRef2.php" method="POST" id="f">

        <input type="checkbox" id="flag" name="check">
        <input type="checkbox" id="solution" />
        <div class=" title">
            <div class="inhalt">
                <div style="margin: 10px 70px;font-size: 18px; position: absolute; float : left;"><a href="http://localhost">Startseite</a></div>

                <h1> WEB Exploitation</h1>
            </div>
        </div>

        <div class="box">
            <h1> XSS-Injection</h1>
            <ul>
                <li>
                    <a href="../../Einleitung/einleitung2.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><a href="xssRef1.php" style="color :#0c2461; text-decoration:none;"> Reflektiertes XSS</a>

                </li>
                <li><span style="color:#0c2461">Persistentes XSS</span>
                    <label for="flag" class="flag">Persistentes XSS</label>
                </li>

            </ul>
        </div>

        <div class="Rahmen">
            <?php

            $flag = trim($_POST['flag_eingabe']);
            if ($flag == "done_Ref26254" && (isset($_POST['flag_btn']))) {
                echo ' <script type="text/javascript">
                 window.location.href = "/xssChallenge/xssPers1.php";
                   </script>';
            }
            ?>

            <div>
                <p style="color:blue; margin:10px 160px;position: absolute;"> Challenge 1: Demonstration einer reflektierten XSS-Injection </p>
            </div>
            <div>
                <p style="position: absolute;margin: 52px 40px;font-size: 14px;"> Diese Challelge ist aufeinander in 3 Stufen aufgebaut. Um von einer zu anderen Stufe zu kommen muss ein Code im Textfeld eingegeben werden. Einen Code bekommst du, wenn du die jeweilige Stufe gelöst hast. </p></br><br><br>
            </div>
            <div>
                <p style="margin: 35px 41px;font-size: 14px;"> Nachdem alle 3 Stufen gelöst wurden, erhältst du den Flag für die nächste Challenge "Persistentes XSS".</p>
            </div>

            <div style="margin: -15px 88px; background-color: #06f206bf;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <a href="xssRef1.php" style=" color:black; margin: 17px 30px; position: absolute; text-decoration:none;"> Einfach</a>
            </div>
            <div style="margin: -15px 240px; background-color: #06f20659;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <span style=" color:black;position:absolute; margin:17px 38px;">Mittel</span>
            </div>
            <div style="margin: -15px 390px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <span style=" color:black;position:absolute; margin:17px 33px;">Schwer</span>
            </div>
            <div style="margin: -15px 540px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
                <label for="solution" style=" color:black;position:absolute; margin:17px 27px;">Lösungen</label>
            </div>
            <div class="deco_rahmen">
                <div class="inhalt_rahmen">
                    <p style="margin: 15px 100px;"><br>Geben Sie den Code ein: </p> <input type="text" name="code" style="margin: -43px 315px; position:absolute;">

                    <button type="submit" name="sub" style="color: green; margin: -39px 544px;position:absolute;">Submit</button>

                    <?php $text = $_POST['text'];
                    $aufgabe = "<script> alert(window.location.host)</script>";
                    $aufgabe1 = "<script>alert(window.location.host)</script>";
                    if ($text == $aufgabe | $text == $aufgabe1) {
                        $Confirmation = "<script> window.confirm('Glückwünsch!  Code fuer naechste Stufe: 22');   </script>";
                        if ($Confirmation == true) {
                            echo $Confirmation;
                        }
                        echo '<p style="font-size:17px; position: absolute;margin: 1px 365px;"><strong> Code ist 22</strong></p>';
                    } ?>
                    <div style="background-color: #0000001a;height: 180px;margin: 44px 32px;width: 820px;">
                        <div style="background-color: white;position: absolute;height: 160px;width: 800px;margin: 10px 10px;">
                            <?php
                            if (($_POST["code"]) == 22) {

                                echo ' <script type="text/javascript">
                                window.location.href = "xssRef3.php";
                                </script>';
                            } else {
                                echo  '<span style="position: absolute;width: 730px;margin: 45px 48px;" ><strong> Stufe 2: </strong>Erstelle ein XSS payload, die ein Popup mit dem Host deines Rechners anzeigt.</span>';
                            }

                            ?>
                        </div>
                    </div>
                    <?php
                    $text = $_POST['text'];
                    $str = htmlentities($text);
                    echo  $text . "<br><br><br><br>";
                    ?>
                    <p style="margin: -47px 10px;"> Antwort eingeben: </p>
                    <input type="text" name="text" style="position: absolute;margin: 22px 167px;">
                    <button type="submit" name="submit" style="color:blue;position: absolute;margin: 25px 397px;width: 178px;">Eingaben absenden</button>

                </div>
            </div>
        </div>
        <div class="flag_popup">
            <div class="flag_eingabe">
                <input type="text" id="flag_text" name="flag_eingabe" autocomplete="off" placeholder="Geben sie Flag ein:" style="width: 322px;height: 40px; margin: 1px 20px; ">
            </div>
            <div class="flag_btn">
                <input type="submit" name="flag_btn" value="submit" style="  height: 40px;width: 350px; margin: 10px 30px;
                    background: #00dbff52; border-top-right-radius: 10px; border-top-left-radius: 10px;border-bottom-right-radius: 10px; border-bottom-left-radius: 10px;">
            </div>
        </div>
        <div class="hint" style="margin: 0px -90px;">
            <ul>
                <li>
                    <p style="margin: 3px 16px;">Hinweis1</p>
                    <div class="content">

                        <p style="margin: -7px -4px;"> Das window.location-Objekt kann verwendet werden, <br><br>um die aktuelle Seitenadresse(URL) zu ermitteln<br><br>und den Browser auf eine neue Seite umzuleiten. <br><br>
                        </p>
                    </div>

                </li>
                <li>
                    <p style="margin: 3px 16px;">Hinweis2</p>
                    <div class="content">

                        <p style="margin:22px 5px;"> Ein Beispiel von Zurückgeben einer URL der aktuellen Seite ist:<br> <br> window.location.href <br><br>

                        </p>
                    </div>

                </li>
            </ul>
        </div>
        <div class="Solution">
            <p style="margin: 50px 30px"> Stufe 2: <*script> alert(window.location.host)<* /script> <br><br> * - Ohne Leerzeichen<br></p>
        </div>
    </form>
    <form action="../xssMain.php" method="POST" style="width: 0px; height:0px; margin:0px 0px;">
        <div class="back" style="margin: 90px -445px;position: absolute;"><input type="submit" name="back1" value="Zurück zur Challenge Seite" style="    background: none;   border: none;color: Blue;"></div>
    </form>

    <body>
        <html>