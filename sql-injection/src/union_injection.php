
<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <base href="http://localhost:8026"/>
    <link rel="stylesheet" href="style.css">

</head>

<body>

    <form action="index.php" method="GET" id="f">
        <input type="checkbox" id="hint1" name="check" />
        <input type="checkbox" id="hint2" name="check" />
        <input type="checkbox" id="hint3" name="check" />
       
        <div class=" title">
            <div class="inhalt">
<div style ="margin: 10px 70px;font-size: 18px; position: absolute; float : left;"><a href="http://localhost">Startseite</a></div>
                <h1> WEB Exploitation</h1>
            </div>
        </div>

        <div class="box">
            <h1> SQL-Injection</h1>
            <ul>
                  <li>
                    <a href="einleitung1.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><button type="submit" name="stufe1"> Stufe 1 </button>

                </li>
                <li><span style="color:#0c2461">Stufe 2</span>
                    <label for="flag1" class="flag1">ROUND1</label>
                </li>

            </ul>
        </div>
        <div class="box">
            <h1> XSS-Injection</h1>
            <ul>
                 <li>
                    <a href="einleitung1.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><span style="color:#0c2461"> Reflektiertes XSS </span>
                    <label for="flag2" class="flag2">Reflektiertes XSS Reflektiertes XSS</label>
                </li>
                <li><span style="color:#0c2461"> Persistentes XSS </span>
                    <label for="flag3" class="flag3">Persistentes XSS Persistentes XSS</label>
                </li>

            </ul>
        </div>
        <div class="rahmen">

            <div class="box">

                <div class="auswahl">
                    <?php

                    echo '<div ><strong><span style =" color:blue">Challenge 2: Unberechtigter Datenzugriff </strong></div>';
                    echo "<br/>";
                    echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 126px -166px; position: absolute;">1. Betimme genau Anzahl der Spalten in der Datenbank. </strong></div>';
			$orderby1 ='SELECT * FROM Filiale order by 1,2,3,4,5';
			$orderby2 ="SELECT * FROM Filiale order by 5";

//if($s ==$orderby1 | $s==$orderby2){
//echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 146px -166px;
// position: absolute;">2. Suche nach einer Spalte, die String enthält  </strong></div>';
//}

//$unionselect ="retert";
//if($s ==$unionselect){
//echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 166px -166px; position: absolute;"> 3. Abrufen von Daten aus anderen Tabellen.  </strong></div>';
//}

                    echo '<div class ="hints" style="margin: 133px 29px;padding: 62px 0px;width:91px"> Hinweis 1.1<label for="hint1" class="begin">Hinweis 1</label>  </div>';
                   echo '<div class ="hints"style="margin: 133px 154px;padding: 62px 0px;width:91px">  Hinweis 1.2<label for="hint2" class="begin">Hinweis 2</label>  </div>';
                   echo '<div class ="hints"style="margin: 133px 281px;padding: 62px 0px;width:91px">  Hinweis 1.3<label for="hint3" class="begin">Hinweis 3</label>  </div>';
                  // echo '<div class ="hints" style="margin: 181px 29px;padding: 62px 0px;width:91px"> Hinweis 2.1<label for="hint2.1" class="begin">Hinweis 1</label>  </div>';
                  // echo '<div class ="hints"style="margin: 181px 154px;padding: 62px 0px;width:91px">  Hinweis 2.2<label for="hint2.2" class="begin">Hinweis 2</label>  </div>';
                  // echo '<div class ="hints"style="margin: 181px 281px;padding: 62px 0px;width:91px">  Hinweis 2.3<label for="hint2.3" class="begin">Hinweis 3</label>  </div>';

                  include 'sql_conn.php';
                  $id = $_GET['id'];
                  $a = explode(' ', $id, 2);
                  $s = "SELECT * FROM Filiale $a[1]";
// UNION SELECT NULL, "a","a","a","a";
//echo"</br></br></br>".$s;
//$resulti = mysqli_query($conn, $s) or trigger_error("Query Failed! SQL: $s - Error: " );
//if($s ==$orderby1| $s==$orderby2){
//echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 146px -166px; position: abso>
//}

$unionselect ="retert";
if($s ==$orderby1| $s==$orderby2){
echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 146px -166px;position: absolute;">2. Suche nach einer Spalte, die String enthält  </strong></div>';}

$resulti = mysqli_query($conn, $s) or trigger_error("Query Failed! SQL: $s - Error: " );

echo '<table width=\"35%\" border=\"1\" cellpadding=\"0\" cellspacing=\"2\" style="margin: 273px 21px;" ><tr><th>Filiale</th><th>Standort</th><th>Land</th></tr>';
    while ($aus =  $resulti->fetch_object()) {

        #echo $aus->username."-". $aus->password;
        echo " <tr>";
        echo "<td align='center'>" . $aus->Filiale . "</td>";
        echo "<td align='center'>"  . $aus->Standort . "</td>";
        echo "<td align='center'>"  . $aus->Land . "</td>";
        echo "<br />";
    }

    echo "</tr>";
    echo "</table>";
    echo "</br> ";
?>
</div>
</div>
</div>
<div class="hints_union1"><span> Hinweis 1: Wenn eine URL möglicherweise mit * ? * = * endet und mit einer Datenbank kommuniziert wird, dann kannst es ausnutzen. </br></br> - Um zu prüfen, ob die Website für SQL-Injection geeignet ist, füge einfach ein * ' * am Ende der Abfrage ein. Zum Beispiel:</br></br>www.example.com/index.php?id=5 ′ </span></div>
<div class="hints_union2"><span> Hinweis 2: Wenn die Anfrage Fehlermeldung schickt, heißt diese Webseite SQL-Injection durchführbar. </br></br> - Um die genau Anzahl der Spalten zu finden, kannst du folgende Anfrage Ausführen: (n-> Nummer von Spalten) </br></br> www.example.com/index.php?id=5 ORDER BY  * n * .</span></div>
<div class="hints_union3"><span> Hinweis 3: Wenn die Ausführung bei der n-te Spalte eine Fehlermeldung zeigt, heißt n-te Spalte existiert nicht. </span></div>
 </form>
<form action="index.php" method="POST" >

<div class ="back" style="margin: 339px -135px;position: absolute;"><input type ="submit" name ="back" value="Back"></div> 
</form>
</body>

</html>
