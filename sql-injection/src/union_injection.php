
<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <base href="http://localhost:8026"/>
    <link rel="stylesheet" href="/css/style.css">

</head>

<body>

    <form action="index.php" method="GET" id="f">
        <input type="checkbox" id="hint1" name="check" />
        <input type="checkbox" id="hint2" name="check" />
        <input type="checkbox" id="hint3" name="check" />
        <input type="checkbox" id="hint4" name="check" />
	<input type="checkbox" id="hint5" name="check" />
	<input type="checkbox" id="hint6" name="check" />
        <input type="checkbox" id="hint7" name="check" />
	<input type="checkbox" id="hint8" name="check" />

        <div class=" title">
            <div class="inhalt">
<div style ="margin: 10px 70px;font-size: 18px; position: absolute; float : left;"><a href="http://localhost">Startseite</a></div>
                <h1> WEB Exploitation</h1>
            </div>
        </div>

        <div class="box">
            <h1> SQL-Injection</h1>
            <ul>
                  <li>
                    <a href="Einleitung/einleitung1.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><button type="submit" name="stufe1"> Angreifbare Login Seite </button>

                </li>
                <li><span style="color:#0c2461"> Union-SQL-Injection</span>
                    <label for="flag1" class="flag1"></label>
                </li>

            </ul>
        </div>
        <div class="box">
            <h1> XSS-Injection</h1>
            <ul>
                 <li>
                    <a href="Einleitung/einleitung2.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><span style="color:#0c2461"> Reflektiertes XSS </span>
                    <label for="flag2" class="flag2">Reflektiertes XSS Reflektiertes XSS</label>
                </li>
                <li><span style="color:#0c2461"> Persistentes XSS </span>
                    <label for="flag3" class="flag3">Persistentes XSS Persistentes XSS</label>
                </li>

            </ul>
        </div>
        <div class="rahmen">

            <div class="box">

                <div class="auswahl">
                    <?php

                    echo '<div ><strong><span style =" color:blue; font-size:14px;">Challenge 2: Wie viele Umsätze haben die Filialen insgesamt gemacht? </strong></div>';
                    echo "<br/>";
                    echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 126px -186px; position: absolute;">1. Betimme die genaue Anzahl der Spalten in der Datenbank. </strong></div>';

                   echo '<div class ="hints" style="margin: 225px 60px;width:91px"> <label for="hint1" id="hinweis"class="begin">Hinweis 1.1</label>  </div>';
                   echo '<div class ="hints"style="margin: 225px 177px;width:91px"> <label for="hint2" id="hinweis"class="begin">Hinweis 1.2</label>  </div>';
                   echo '<div class ="hints"style="margin: 225px 295px;width:91px">  <label for="hint3" id="hinweis" class="begin">Hinweis 1.3</label>  </div>';
		   echo '<div class ="hints"style="width:91px;padding: 0px 15px;text-align: end;"> <label id="hinweis" for="hint4" class="begin" style="margin: 218px -88px;">Hinweis 2.1</label></div>';
		   echo '<div class ="hints"style="width:91px;padding: 0px 15px;text-align: end;"> <label id="hinweis" for="hint5" class="begin" style="margin: 218px 30px;">Hinweis 2.2</label></div>';
	           echo '<div class ="hints"style="width:91px;padding: 0px 15px;text-align: end;"> <label id="hinweis" for="hint6" class="begin" style="margin: 218px 147px;">Hinweis 2.3</label></div>';                  
		   echo '<div class ="hints"style="width:91px;padding: 0px 15px;text-align: end;"> <label id="hinweis" for="hint7" class="begin" style="margin: 260px -88px;">Hinweis 3.1</label></div>';
		   echo '<div class ="hints"style="width:91px;padding: 0px 15px;text-align: end;"> <label id="hinweis" for="hint8" class="begin" style="margin: 260px 30px;">Hinweis 3.2</label></div>';
	
		include 'sql_conn.php';
                  $id = $_GET['id'];
                  $a = explode(' ', $id, 2);
                  $s = "SELECT * FROM Filiale $a[1]";

echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 146px -186px;position: absolute;">2. Suche nach anfälligen Spalten, die String enthält  </strong></div>';
echo '<div style="color: black; text-align: left; margin: -133px 203px; font-size: 14px;position: absolute;  width: 315px;"><strong style ="margin: 166px -186px;position: absolute;">3. Abrufen von Daten aus anderen Tabellen.  </strong></div>';

echo"<br><br>";
$resulti = mysqli_query($conn, $s) or trigger_error("Query Failed! SQL: $s - Error: " );

echo '<table width=\"35%\" border=\"1\" cellpadding=\"0\" cellspacing=\"2\" style="margin: 265px 21px;line-height: 19px;" ><tr><th>Filiale</th><th>Standort</th><th>Land</th></tr>';


while ($aus =  $resulti->fetch_object()) {
if($aus->Filiale==480|$aus->Standort==480|$aus->Land==480){
echo'<strong style="color: green; font-size:15px"> Herzlichen Glückwunsch!</strong> <span style="font-size:12px;">-- Dein Flag für nächste Challenge ist 480.</span> ';echo"<br><br>";
echo" Wenn du nächste Challenge beginnen möchtest,<br> drück bitte  * Back * Buttom."; }
        echo " <tr>";
        echo "<td align='center'>" . $aus->Filiale . "</td>";
        echo "<td align='center'>"  . $aus->Standort . "</td>";
        echo "<td align='center'>"  . $aus->Land . "</td>";
        echo "<br />";
    }

    echo "</tr>";
    echo "</table>";
    echo "</br> ";
?>
</div>
</div>
</div>

<div class="hints_u1"><span><strong> Hinweis 1.1:</strong> Wenn eine URL möglicherweise mit * ? * = * endet und mit einer Datenbank kommuniziert wird, dann kannst es ausnutzen. </br></br> - Um zu prüfen, ob die Website für SQL-Injection geeignet ist, füge einfach ein * ' * am Ende der Abfrage ein. Zum Beispiel:</br></br>  <strong style="margin: 10px 95px;">http://localhost/index.php?id=5 ′</strong></span></div>
<div class="hints_u2"><span> <strong>Hinweis 1.2:</strong> Wenn die Anfrage Fehlermeldung schickt, heißt diese Webseite SQL-Injection durchführbar. </br></br> - Um die genau Anzahl der Spalten zu finden, kannst du folgende Anfrage Ausführen: (n-> Nummer von Spalten) </br></br> <strong style="margin: 10px 25px;">http://localhost/index.php?id=5 ORDER BY  * n * .</strong></span></div>
<div class="hints_u3"><span> <strong>Hinweis 1.3:</strong> Wenn die Ausführung bei der n-te Spalte eine Fehlermeldung zeigt, heißt n-te Spalte überschritten. </span></div>
<div class="hints_u4"><span> <strong>Hinweis 2.1:</strong> Wenn du exakte Anzahl der Spalten von vorheriger Aufgabe kennst, kannst du jetzt einfach aller anfälligen Spalten herausfinden. </br></br> Mit dem UNION Befehl kann man die Abfrage von zwei oder mehr SELECT’s kombinieren. Zum Beispiel: </br><strong> http://localhost/index.php?id=5 UNION SELECT spalten_name FROM tabelle2 </strong></span></div> 
<div class="hints_u5"><span> <strong>Hinweis 2.2:</strong>  Name der Tabelle2 findest du von der Fehlermehldung beim Query. </span></div> 
<div class="hints_u6"><span> <strong>Hinweis 2.3:</strong> Wenn man UNION Operator nutzt, muss die Anzahl der Spalten in der Tabelle gleich sein. Ansonsten bekommst du Fehlermeldung. Folgende Operator kannst du fuer Ausfuerung nutzen: <br><br><strong>* NULL *:</strong> Täuscht eine leere Spalte vor <br> <strong>* , * :</strong> Trennen einer Spalte von einer anderen <br> <strong>* 'a' * :</strong>  Überprüpfung einer anfälligen Spalte. </span></div> 
<div class="hints_u7"><span> <strong>Hinweis 3.1:</strong> Wenn du alle anfälligen Spalten gefunden hast, kannst du jetzt Daten aus anderen Tabellen abrufen.<br><br>-Mithilfe von MYSQL Aggregierte Funktionen und Gruppierung kannst du Daten zugreifen. Dazu gehören zum Beispiel:<br><br><strong>SUM(expr) : </strong> Funktion gibt die Summe eines Ausdrucks zurück<br><strong> COUNT(expr):</strong>Funktion gibt eine Anzahl von Nicht NULL Werten zurück<br><strong>GROUP_CONCAT(expr): </strong> Funktion gibt nicht NULL String Wert zurück  </span></div> 
<div class="hints_u8"><span> <strong> Hinweis 3.2:</strong> * Zeichen wird allen Hinweisen um die Angaben zu trennen genutzt. </span></div> 

</form>
<form action="index.php" method="POST" id="back">

<div class ="back" style="margin:377px -148px;position: absolute;"><input type ="submit" name ="back" value="Zurück"></div> 
</form>

</body>

</html>

