# syntax=docker/dockerfile:1

FROM node:17.3.1-alpine3.15

EXPOSE 3000

WORKDIR /app

RUN npm init -y
RUN npm install --save express ejs cors bootstrap sass sqlite3

COPY app.js ./
COPY assets/ assets/
COPY views/ views/
COPY scss/ scss/
COPY webfonts/ webfonts/
# COPY js/ js/

COPY progress-schema.sql ./

RUN node_modules/.bin/sass --no-source-map scss/:css/

RUN apk add sqlite=3.36.0-r0
RUN mkdir -p /app/db
RUN sqlite3 /app/db/progress.db < ./progress-schema.sql

CMD node app.js