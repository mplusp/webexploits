#!/bin/bash

# Referenced https://www.kali.org/docs/containers/installing-docker-on-kali/ and
# https://docs.docker.com/engine/install/linux-postinstall/
# on 2022-01-29 to create this installation script.
# Some of the commentary on these sites is copied into this script for
# explanation purposes.

# docker-ce can be installed from Docker repository. One thing to bear in mind,
# Kali Linux is based on Debian, so we need to use Debian’s current stable
# version (even though Kali Linux is a rolling distribution). At the time of
# writing (Dec. 2021), its “bullseye”:
printf '%s\n' "deb https://download.docker.com/linux/debian bullseye stable" | sudo tee /etc/apt/sources.list.d/docker-ce.list

# Import the gpg key:
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/docker-ce-archive-keyring.gpg

# Install the latest version of docker-ce + docker-compose:
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-compose

# Enable docker on boot:
sudo systemctl enable docker --now

# Create the docker group:
sudo groupadd docker

# You can now get started with using docker, with sudo. If you want to add yourself to the docker group to use docker without sudo, an additional step is needed:
sudo usermod -aG docker $USER

# On Linux, you can also run the following command to activate the changes to groups:
newgrp docker